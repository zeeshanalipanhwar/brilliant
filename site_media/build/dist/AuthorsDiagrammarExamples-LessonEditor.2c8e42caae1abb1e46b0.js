(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([[29],{1114:function(e,t,n){var r=n(2235);if(typeof r==="string")r=[[e.i,r,""]];if(r.locals)e.exports=r.locals;var i=n(28).default;var a=i("0ff287ca",r,false,{});if(false){}},1115:function(e,t,n){var r=n(2237);if(typeof r==="string")r=[[e.i,r,""]];if(r.locals)e.exports=r.locals;var i=n(28).default;var a=i("c1002eb6",r,false,{});if(false){}},1116:function(e,t,n){var r=n(2239);if(typeof r==="string")r=[[e.i,r,""]];if(r.locals)e.exports=r.locals;var i=n(28).default;var a=i("31c835e6",r,false,{});if(false){}},1117:function(e,t,n){var r=n(2241);if(typeof r==="string")r=[[e.i,r,""]];if(r.locals)e.exports=r.locals;var i=n(28).default;var a=i("6f597dee",r,false,{});if(false){}},1118:function(e,t,n){var r=n(2243);if(typeof r==="string")r=[[e.i,r,""]];if(r.locals)e.exports=r.locals;var i=n(28).default;var a=i("7180f80f",r,false,{});if(false){}},1397:function(e,t,n){"use strict";var r=function(){var e=this;var t=e.$createElement;var n=e._self._c||t;return n("div",{staticClass:"viz-wrapper clearfix",attrs:{"data-interactivekey":e.interactiveKey}},[n("div",{attrs:{id:e.interactiveKey}})])};var i=[];r._withStripped=true;var a=n(1);var s=n(5);let o=class e extends s["e"]{constructor(){super(...arguments);this.debounceTimer=null;this.interactiveError=null;this.interactiveInstance=null}reloadInteractive(){clearTimeout(this.debounceTimer);this.debounceTimer=setTimeout(()=>{try{this.getModuleForInteractiveType().then(e=>{if(e===undefined){return null}if(this.interactiveInstance&&this.interactiveInstance.kill){this.interactiveInstance.kill()}try{this.interactiveInstance=e.default.createInteractive({visualizationKey:this.interactiveKey,slug:this.interactive.alias,authoredData:this.authoredData,generatedData:this.interactive.generatedData,onError:e=>{this.$emit("interactive-error",e);this.interactiveError=e},location:"v2-editor"})}catch(e){this.$emit("interactive-error",e);throw e}})}catch(e){this.interactiveError=e;throw e}},100)}interactiveChanged(e,t){if(this.interactive.type!=="diagrammar"&&JSON.stringify(e.json||{})!==JSON.stringify(t.json||{})){this.reloadInteractive()}}mounted(){this.$root.$on("pull-from-viz-requested",e=>{if(this.interactiveInstance&&this.interactiveKey==="bigPreview"){this.interactiveInstance.getConfigValue(e).then(t=>{if(t){this.$root.$emit("pull-from-viz-succeeded",{path:e,value:t})}})}})}getModuleForInteractiveType(){return Object(a["a"])(this,void 0,void 0,(function*(){switch(this.interactive.type){case"diagrammar":return yield Promise.all([n.e(1),n.e(3),n.e(2),n.e(6),n.e(8),n.e(23),n.e(5),n.e(7),n.e(208)]).then(n.bind(null,306));case"calcdoku":return yield Promise.all([n.e(1),n.e(3),n.e(2),n.e(6),n.e(4),n.e(5),n.e(203)]).then(n.bind(null,300));case"gridfill":return yield Promise.all([n.e(1),n.e(3),n.e(2),n.e(6),n.e(4),n.e(5),n.e(212)]).then(n.bind(null,297));case"hotcold":return yield Promise.all([n.e(1),n.e(3),n.e(2),n.e(6),n.e(4),n.e(5),n.e(214)]).then(n.bind(null,283));case"neuralnetworks":return yield Promise.all([n.e(1),n.e(3),n.e(2),n.e(6),n.e(4),n.e(5),n.e(218)]).then(n.bind(null,302));case"numberbunchers":return yield Promise.all([n.e(1),n.e(3),n.e(2),n.e(6),n.e(4),n.e(5),n.e(219)]).then(n.bind(null,299));case"orderlogic":return yield Promise.all([n.e(1),n.e(3),n.e(2),n.e(6),n.e(4),n.e(5),n.e(221)]).then(n.bind(null,298));case"parson":return yield Promise.all([n.e(1),n.e(3),n.e(2),n.e(6),n.e(4),n.e(5),n.e(222)]).then(n.bind(null,303));case"toggletags":return yield Promise.all([n.e(1),n.e(3),n.e(2),n.e(6),n.e(4),n.e(5),n.e(225)]).then(n.bind(null,305));case"elmconfig":return;default:throw new Error(`Unknown interactive type '${this.interactive.type}'`)}}))}get authoredData(){if(this.interactive.type==="diagrammar"){return this.interactive.elm}try{return JSON.parse(this.interactive.json)}catch(e){throw new Error(`Invalid JSON: ${e}`)}}};Object(a["b"])([Object(s["c"])(Object)],o.prototype,"interactive",void 0);Object(a["b"])([Object(s["c"])(String)],o.prototype,"interactiveKey",void 0);Object(a["b"])([Object(s["f"])("interactive")],o.prototype,"interactiveChanged",null);o=Object(a["b"])([s["a"]],o);var l=o;var c=l;var d=n(2240);var u=n(10);var h=Object(u["a"])(c,r,i,false,null,"034bd9e4",null);if(false){var f}h.options.__file="frontend/views/lessons/editor/InteractivePreview.vue";var m=t["a"]=h.exports},1398:function(e,t,n){"use strict";var r=function(){var e=this;var t=e.$createElement;var n=e._self._c||t;return n("InteractivePreview",{ref:"preview",class:{preview:true,dim:e.isLoadingPreview},attrs:{interactive:e.interactive,"interactive-key":e.interactiveKey},on:{"interactive-error":e.handleInteractiveError}})};var i=[];r._withStripped=true;var a=n(1);var s=n(5);var o=n(264);var l=n(885);var c=n(899);var d=n(898);var u=n(1397);var h=n(810);let f=class e extends s["e"]{constructor(){super(...arguments);this.compilationErrors=[];this.previewJavascript="";this.isLoadingPreview=false;this.hasBeenEditedSinceRemotePreview=false;this.cursorPosition={line:0,ch:0};this.showFigmaModal=false}get interactive(){return Object.assign(Object.assign({},this.asset),{generatedData:{javascript:this.staticJavascript||this.previewJavascript}})}assetChanged(){this.handleIncomingData()}reloadInteractive(){this.$refs.preview.reloadInteractive()}updateDiagrammarPreview(){return Object(a["a"])(this,void 0,void 0,(function*(){this.setIsLoadingPreview(true);const e={elm_code:this.asset.elm};try{const t=yield fetch("/courses/interactives/diagrammar/compile/",{body:JSON.stringify(e),method:"POST",headers:{"Content-Type":"application/json","X-CSRFToken":Object(o["a"])()}});const{results:n}=yield t.json();const{errors:r,javascript:i}=n.elmer_result;if(!r){this.previewJavascript=i;this.reloadInteractive()}else{let e;if(r.type==="compile-errors"){e=r.errors.map(e=>e.problems.map(e=>Object(h["a"])(e.message))).flat().join("\n------------------------\n");const t=r.errors.filter(({path:e})=>e.endsWith("Main.elm"))[0];if(t){this.compilationErrors=t.problems.map(h["b"])}}else if(Array.isArray(r.message)&&r.message.length>0){e=Object(h["a"])(r.message);if(r.title){e=`${r.title}\n\n${e}`}}else{e=`${r}`}this.sendInteractiveErrorMessage(e)}this.setIsLoadingPreview(false);this.hasBeenEditedSinceRemotePreview=false}catch(e){this.sendInteractiveErrorMessage(e.stack)}}))}sendInteractiveErrorMessage(e){this.$emit("interactive-error",e)}setIsLoadingPreview(e){this.isLoadingPreview=e;this.$emit("is-loading-preview",this.isLoadingPreview)}handleInteractiveError(e){this.sendInteractiveErrorMessage(`${e.message}\n${e.stack}`)}handleIncomingData(){if(this.staticJavascript){this.reloadInteractive()}else{this.updateDiagrammarPreview()}}mounted(){this.handleIncomingData()}};Object(a["b"])([Object(s["c"])(Object)],f.prototype,"asset",void 0);Object(a["b"])([Object(s["c"])(String)],f.prototype,"staticJavascript",void 0);Object(a["b"])([Object(s["c"])(String)],f.prototype,"interactiveKey",void 0);Object(a["b"])([Object(s["f"])("asset",{deep:true})],f.prototype,"assetChanged",null);f=Object(a["b"])([Object(s["a"])({components:{AssetsUploader:l["a"],CodeEditor:d["a"],FigmaImportModal:c["a"],InteractivePreview:u["a"]}})],f);var m=f;var p=m;var v=n(2242);var g=n(10);var b=Object(g["a"])(p,r,i,false,null,"47f0b12f",null);if(false){var w}b.options.__file="frontend/views/lessons/editor/DiagrammarPreview.vue";var y=t["a"]=b.exports},2234:function(e,t,n){"use strict";var r=n(1114);var i=n.n(r);var a=i.a},2235:function(e,t,n){t=e.exports=n(27)(false);t.push([e.i,'@charset "UTF-8";\n@use "sass:map";\n.no-scroll[data-v-00b49118] {\n  position: relative;\n  z-index: 100;\n  overflow: hidden;\n}\n.editor[data-v-00b49118] {\n  flex: 1;\n  display: flex;\n  flex-direction: column;\n}\n.editor[data-v-00b49118] .CodeMirror {\n    height: 100%;\n    font-size: 0.9em;\n    line-height: 1.6em;\n    font-family: "Source Code Pro", monospace;\n}\n.editor .lang[data-v-00b49118] {\n    display: flex;\n    align-items: center;\n    width: 100%;\n    height: 20px;\n    padding: 0 16px;\n    border-bottom: 1px solid #ccc;\n    font-size: 12px;\n    color: rgba(0, 0, 0, 0.5);\n}\n.editor .editor-container[data-v-00b49118] {\n    flex: 1;\n    overflow: hidden;\n}\n.editor .editor-container.y-scroll[data-v-00b49118] {\n      overflow-y: scroll;\n}\n.editor .error-container[data-v-00b49118] {\n    display: flex;\n    flex-direction: column;\n    flex: none;\n    max-height: 50%;\n}\n.editor .error-container .error-toggle[data-v-00b49118] {\n      display: flex;\n      align-items: center;\n      background: #F8F7F6;\n      border-top: 1px solid #C2C4CF;\n      padding: 0 8px;\n      cursor: pointer;\n}\n.editor .error-container .error-toggle[data-v-00b49118]:hover {\n        opacity: 0.7;\n}\n.editor .error-container .error-toggle small[data-v-00b49118] {\n        color: #899098;\n}\n.editor .error-container .error-toggle span[data-v-00b49118] {\n        margin-right: 4px;\n        -webkit-transform: scale(0.6);\n                transform: scale(0.6);\n        opacity: 0.6;\n}\n.editor .error-container .error-toggle span.hidden[data-v-00b49118] {\n          -webkit-transform: rotate(-90deg) scale(0.6);\n                  transform: rotate(-90deg) scale(0.6);\n}\n.editor .errors[data-v-00b49118] {\n    overflow: auto;\n    padding: 8px 16px;\n    border-top: 1px solid #ccc;\n    color: tomato;\n    background: #FFFFFF;\n}\n.editor .errors h3[data-v-00b49118] {\n      margin: 12px 0 4px;\n      font-size: 14px;\n      color: tomato;\n}\n.editor .errors ul[data-v-00b49118] {\n      margin: 0;\n      list-style: none;\n      font-size: 14px;\n}\n.editor .errors pre[data-v-00b49118] {\n      margin: 0;\n      font-size: 14px;\n}\n.editor .interactives[data-v-00b49118] {\n    justify-content: center;\n    align-items: center;\n}\n.editor .elm[data-v-00b49118] {\n    font-size: 14px;\n    line-height: 1.5em;\n}\n.editor .elm pre[data-v-00b49118] {\n      margin: 0;\n      padding: 12px 16px;\n      overflow: auto;\n}\n.editor-container[data-v-00b49118] .CodeMirror-dialog {\n  font-size: 0.9em;\n}\n.editor-container[data-v-00b49118] .CodeMirror-dialog input {\n    margin-bottom: 0;\n}\n.editor-container[data-v-00b49118] .CodeMirror-foldmarker {\n  text-shadow: none;\n  color: rgba(0, 0, 0, 0.3);\n}\n.editor-container[data-v-00b49118] .CodeMirror-merge-copy {\n  color: transparent;\n}\n.editor-container[data-v-00b49118] .CodeMirror-merge-copy:hover:after {\n    color: #000000;\n}\n.editor-container[data-v-00b49118] .CodeMirror-merge-copy:after {\n    content: \'←\';\n    margin-top: 2px;\n    color: rgba(0, 0, 0, 0.5);\n}\n.editor-container[data-v-00b49118] .cm-s-ttcn .cm-comment {\n  color: rgba(0, 0, 0, 0.4);\n}\n.editor-container[data-v-00b49118] .cm-s-ttcn .cm-camp-block,\n.editor-container[data-v-00b49118] .cm-s-ttcn .cm-camp-step {\n  color: #000000;\n  font-weight: bold;\n}\n.editor-container[data-v-00b49118] .cm-s-ttcn .cm-camp-bold {\n  font-weight: bold;\n  opacity: 0.7;\n}\n.editor-container[data-v-00b49118] .cm-s-ttcn .cm-camp-italic {\n  font-style: oblique;\n}\n.editor-container[data-v-00b49118] .cm-s-ttcn .cm-camp-line-block {\n  background: rgba(72, 209, 204, 0.3);\n}\n.editor-container[data-v-00b49118] .cm-s-ttcn .cm-camp-line-step {\n  background: rgba(72, 209, 204, 0.1);\n}\n.editor-container[data-v-00b49118]  .cm-indent {\n  position: relative;\n}\n.editor-container[data-v-00b49118]  .cm-indent:before {\n    content: \'\';\n    position: absolute;\n    top: -1px;\n    left: 0;\n    bottom: -1px;\n    border-left: 1px dashed rgba(0, 0, 0, 0.1);\n}\n.editor-container[data-v-00b49118]  .cm-indent:first-child:before {\n    display: none;\n}\n.editor-container[data-v-00b49118] .CodeMirror .syntax-warning-highlight {\n  border-bottom: 1px dotted tomato;\n}\n.editor-container[data-v-00b49118] .CodeMirror .syntax-warning-gutter {\n  width: 6px;\n}\n.editor-container[data-v-00b49118] .CodeMirror .syntax-warning-gutter-mark {\n  display: inline-block;\n  width: 7px;\n  height: 1.6em;\n  border-right: 4px solid tomato;\n}\n.editor-container[data-v-00b49118] {\n  display: flex;\n}\n.editor-container[data-v-00b49118]  .CodeMirror {\n    flex: 1;\n    height: auto;\n}\n',""])},2236:function(e,t,n){"use strict";var r=n(1115);var i=n.n(r);var a=i.a},2237:function(e,t,n){t=e.exports=n(27)(false);t.push([e.i,'@use "sass:map";\n.no-scroll[data-v-5afe4ba4] {\n  position: relative;\n  z-index: 100;\n  overflow: hidden;\n}\n.figma-modal header[data-v-5afe4ba4] {\n  margin-bottom: 40px;\n}\n.figma-modal h2[data-v-5afe4ba4],\n.figma-modal h3[data-v-5afe4ba4] {\n  margin: 0;\n}\n.figma-modal p[data-v-5afe4ba4] {\n  margin: 0;\n  color: #899098;\n}\n.figma-modal input[type=text][data-v-5afe4ba4] {\n  width: 100%;\n  margin-bottom: 24px;\n  border-color: #161616;\n  border-radius: 7px;\n}\n.figma-modal .preview-container[data-v-5afe4ba4] {\n  min-height: 150px;\n}\n.figma-modal .preview-container .error[data-v-5afe4ba4] {\n    color: tomato;\n    line-height: 1.4em;\n    font-size: 14px;\n}\n.figma-modal .preview-container .loading-anim[data-v-5afe4ba4] {\n    top: 40px;\n    left: 30px;\n}\n.figma-modal .image-preview[data-v-5afe4ba4] {\n  max-width: 100%;\n  margin-bottom: 20px;\n}\n.figma-modal .form-footer[data-v-5afe4ba4] {\n  margin-top: 40px;\n}\n',""])},2238:function(e,t,n){"use strict";var r=n(1116);var i=n.n(r);var a=i.a},2239:function(e,t,n){t=e.exports=n(27)(false);t.push([e.i,'@use "sass:map";\n.no-scroll[data-v-3dda27ef] {\n  position: relative;\n  z-index: 100;\n  overflow: hidden;\n}\n.assets[data-v-3dda27ef] {\n  position: relative;\n}\n.assets ul[data-v-3dda27ef] {\n    margin: -4px -8px 24px;\n    list-style: none;\n}\n.assets li[data-v-3dda27ef] {\n    margin-bottom: 2px;\n}\n.assets input[data-v-3dda27ef] {\n    display: none;\n}\n.assets form p[data-v-3dda27ef] {\n    margin: 0;\n    line-height: 1.4em;\n}\n.btn[data-v-3dda27ef] {\n  min-width: 120px;\n}\n.btn > .loading-anim[data-v-3dda27ef] {\n    margin: auto;\n}\n.empty[data-v-3dda27ef] {\n  display: flex;\n  justify-content: center;\n  align-items: center;\n  width: 100%;\n  height: 100px;\n  color: rgba(0, 0, 0, 0.5);\n  background: rgba(0, 0, 0, 0.05);\n}\n.error[data-v-3dda27ef] {\n  color: tomato;\n}\n.success[data-v-3dda27ef] {\n  color: mediumseagreen;\n}\n',""])},2240:function(e,t,n){"use strict";var r=n(1117);var i=n.n(r);var a=i.a},2241:function(e,t,n){t=e.exports=n(27)(false);t.push([e.i,'@use "sass:map";\n.no-scroll[data-v-034bd9e4] {\n  position: relative;\n  z-index: 100;\n  overflow: hidden;\n}\n.viz-wrapper[data-v-034bd9e4] {\n  margin: 40px 0 64px;\n}\n',""])},2242:function(e,t,n){"use strict";var r=n(1118);var i=n.n(r);var a=i.a},2243:function(e,t,n){t=e.exports=n(27)(false);t.push([e.i,".preview.dim[data-v-47f0b12f] {\n  opacity: 0.5;\n}\n",""])},810:function(e,t,n){"use strict";n.d(t,"e",(function(){return i}));n.d(t,"c",(function(){return a}));n.d(t,"a",(function(){return s}));n.d(t,"b",(function(){return o}));n.d(t,"d",(function(){return l}));n.d(t,"g",(function(){return d}));n.d(t,"f",(function(){return u}));n.d(t,"h",(function(){return h}));var r=n(178);function i(e){return{courseSlug:e.params.courseSlug,chapterSlug:e.params.chapterSlug,lessonSlug:e.params.lessonSlug}}function a(e){switch(e.type){case"compile-errors":return e.errors.map(e=>e.problems.map(e=>e.message.map(e=>{if(typeof e==="string"){return e}if("string"in e){return e.string}return`${e}`}).join("")).join("")).flat().join("\n------------------------\n").replace(/\n\n/g,"\n");case"error":return e.message.join("\n------------------------\n");default:return`${e}`}}function s(e){return e.map(e=>{if(typeof e!=="string"){return e.string}return e}).join("")}function o(e){return{row:e.region.start.line,column:e.region.start.column,type:"error",text:s(e.message)}}function l(e){const t={view:r["b"]};const[n,i,a]=e.hash.split("/");if(i){switch(i){case"camperdown":case"assets":case"settings":case"customElm":case"compiledElmMain":return{view:i,subview:a&&a.trim().length?a:undefined};default:return t}}return t}function c({view:e,subview:t}){if(e==="camperdown"){return undefined}return t?`#/${e}/${t}/`:`#/${e}/`}function d(e,t,n,r=false){const{view:i,subview:a}=l(t);if(i!==n.view||a!==n.subview){const i=Object.assign(Object.assign({},t),{hash:c(n)});if(r){e.replace(i)}else{e.push(i)}}}function u(e,t){const{line:n,ch:r}=e.getCursor();if(n>0&&t<0||n<e.lastLine()&&t>0){const i=`${e.doc.getLine(n)}\n`;e.replaceRange("",{line:n,ch:0},{line:n+1,ch:0});e.replaceRange(i,{line:n+t,ch:0});e.setCursor({ch:r,line:n+t})}}function h(e){return/Apple Computer/.test(e.vendor)||/Mac/.test(e.platform)}},885:function(e,t,n){"use strict";var r=function(){var e=this;var t=e.$createElement;var n=e._self._c||t;return n("div",{staticClass:"assets"},[n("form",{ref:"form",on:{submit:function(t){t.preventDefault();return e.handleUploadForm(t)}}},[n("input",{ref:"fileUpload",attrs:{name:"files",type:"file",accept:e.validFileTypes.join(","),multiple:""},on:{change:e.handleUploadInputChanged}}),e._v(" "),e.buttonStyle==="link"?n("button",{staticClass:"btn-link",attrs:{disabled:e.isUploading||e.lessonIsSaving},on:{click:function(t){t.preventDefault();return e.handleUploadButton(t)}}},[e.isUploading?n("LoadingAnimation",{staticClass:"loading-anim",attrs:{type:"spinner",size:"small",color:"dark"}}):n("span",[e._v(e._s(e.buttonText||"Upload new files"))])],1):n("button",{staticClass:"btn",attrs:{disabled:e.isUploading||e.lessonIsSaving},on:{click:function(t){t.preventDefault();return e.handleUploadButton(t)}}},[e.isUploading?n("LoadingAnimation",{staticClass:"loading-anim",attrs:{type:"dots",size:"small",color:"dark"}}):n("span",[e._v(e._s(e.buttonText||"Upload new files"))])],1),e._v(" "),e.uploadError?n("p",{staticClass:"error"},[e._v(e._s(e.uploadError))]):e._e()]),e._v(" "),n("transition",{attrs:{name:"fade-fast"}},[n("div",{directives:[{name:"show",rawName:"v-show",value:e.enableDropArea,expression:"enableDropArea"}],on:{dragover:e.handleDragOver,dragleave:e.handleDragLeave,drop:e.handleDrop}},[e._t("default")],2)])],1)};var i=[];r._withStripped=true;var a=n(1);var s=n(5);var o=n(9);var l=n(260);let c=class e extends s["e"]{constructor(){super(...arguments);this.isUploading=false;this.isDragging=false;this.uploadError=null;this.validFileTypes=["image/png","image/gif","image/jpeg","image/svg+xml","video/mp4"]}handleUploadButton(){this.$refs.fileUpload.click()}handleUploadForm(){return Object(a["a"])(this,void 0,void 0,(function*(){const e=new FormData(this.$refs.form);this.uploadFiles(e)}))}handleUploadInputChanged(){this.handleUploadForm()}handleDragEnter(e){e.preventDefault();this.isDragging=true}handleDragOver(e){e.preventDefault();this.isDragging=true}handleDragLeave(e){e.preventDefault();this.isDragging=false;this.$emit("dragged-outside")}handleDrop(e){var t;return Object(a["a"])(this,void 0,void 0,(function*(){e.preventDefault();const n=(t=e.dataTransfer)===null||t===void 0?void 0:t.files;this.isDragging=false;this.$emit("dropped");if(n){const e=new FormData;Array.from(n).forEach(t=>{e.append("files",t)});yield this.uploadFiles(e)}}))}isVideoUrl(e){return e.trim().endsWith(".mp4")}validateFiles(e){let t=true;e.getAll("files").forEach(e=>{if(!this.validFileTypes.includes(e.type)){this.uploadError=`File type ${e.type} not allowed for upload`;t=false}});return t}uploadFiles(e){return Object(a["a"])(this,void 0,void 0,(function*(){this.uploadError=null;if(!this.validateFiles(e)){return}this.isUploading=true;this.$emit("is-uploading",true);const t={data:e};const{data:n}=yield this.$store.dispatch("lessonEditor/uploadAssets",t);if(n&&n.length){const e=n.map(e=>{const t=e.split(/\//g);const n=t[t.length-1].replace(/\-\w+\.(png|gif|jpe?g|svg|mp4)$/,"");const r=e;if(this.isVideoUrl(e)){const e={alias:n,url:r,type:"video",behavior:"gif",poster:undefined};return e}const i={alias:n,url:r,type:"image",width:"300",altText:""};return i});this.$emit("assets-added",e)}this.isUploading=false;this.$emit("is-uploading",false)}))}};Object(a["b"])([Object(s["c"])(Boolean)],c.prototype,"enableDropArea",void 0);Object(a["b"])([Object(s["c"])(String)],c.prototype,"buttonStyle",void 0);Object(a["b"])([Object(s["c"])(String)],c.prototype,"buttonText",void 0);c=Object(a["b"])([Object(s["a"])({components:{LoadingAnimation:l["a"]},computed:Object.assign({},Object(o["mapState"])("lessonEditor",["lessonIsSaving"]))})],c);var d=c;var u=d;var h=n(2238);var f=n(10);var m=Object(f["a"])(u,r,i,false,null,"3dda27ef",null);if(false){var p}m.options.__file="frontend/views/lessons/editor/AssetsUploader.vue";var v=t["a"]=m.exports},898:function(e,t,n){"use strict";var r=function(){var e=this;var t=e.$createElement;var n=e._self._c||t;return n("div",{staticClass:"editor"},[e.showLangHeader?n("div",{staticClass:"lang"},[e._v("\n    "+e._s(e.language)+"\n  ")]):e._e(),e._v(" "),n("div",{ref:"editor",class:{"editor-container":true,"y-scroll":e.withScroll}}),e._v(" "),e.camperdownWarnings&&e.camperdownWarnings.length?n("div",{staticClass:"error-container"},[n("div",{staticClass:"error-toggle",on:{click:e.toggleCamperdownWarnings}},[n("span",{staticClass:"b-sprite-courses-chevron-3 inline",class:{hidden:!e.showCamperdownWarnings}}),e._v(" "),n("small",[e._v("Camperdown warnings")])]),e._v(" "),n("div",{directives:[{name:"show",rawName:"v-show",value:e.showCamperdownWarnings,expression:"showCamperdownWarnings"}],staticClass:"errors"},[n("ul",e._l(e.camperdownWarnings,(function(t){return n("li",{key:JSON.stringify(t)},[t.start.line-t.end.line?n("span",[e._v("\n            Lines "+e._s(t.start.line)+" - "+e._s(t.end.line)+": "+e._s(t.message)+"\n          ")]):t.start.ch-t.end.ch?n("span",[e._v("\n            Line "+e._s(t.start.line)+", cols "+e._s(t.start.ch)+"-"+e._s(t.end.ch)+": "+e._s(t.message)+"\n          ")]):n("span",[e._v("\n            Line "+e._s(t.start.line)+", col "+e._s(t.start.ch)+": "+e._s(t.message)+"\n          ")])])})),0)])]):e._e(),e._v(" "),e.elmErrors&&e.elmErrors.length?n("div",{staticClass:"error-container"},[n("div",{staticClass:"error-toggle",on:{click:e.toggleElmErrors}},[n("span",{staticClass:"b-sprite-courses-chevron-3 inline",class:{hidden:!e.showElmErrors}}),e._v(" "),n("small",[e._v("Elm Errors")])]),e._v(" "),n("div",{directives:[{name:"show",rawName:"v-show",value:e.showElmErrors,expression:"showElmErrors"}],staticClass:"errors"},e._l(e.elmErrors,(function(t){return n("pre",{key:t},[e._v("        "+e._s(t)+"\n      ")])})),0)]):e._e()])};var i=[];r._withStripped=true;var a=n(1);var s=n(5);var o=n(9);var l=n(178);var c=n(259);var d=n(261);function u(e){switch(e){case"diagram":case"image":case"video":case"embed":case"embeddedSolution":return e;default:return null}}function h(e,t){const[n,r,i]=e.split(" ").map(e=>e.trim()).filter(e=>e.length>0);const a=u(r);if(a&&i){const n=e.indexOf(i)+1;const r=i.endsWith('"')&&i.length>1?n+i.length-2:Math.max(n,n+i.length-1);const s=e.substring(n,t);return{tokenName:a,partialArg:s,argStart:n,argEnd:r}}return null}function f(e,{tokenName:t,partialArg:n}){return e.filter(e=>{switch(t){case"image":return e.type==="image";case"video":return e.type==="video";case"diagram":return e.type==="diagrammar";case"embed":case"embeddedSolution":return Object(l["h"])(e);default:Object(d["a"])(t)}}).map(e=>e.alias).filter(e=>e.startsWith(n)).sort()}function m(e,t){return n=>{return new Promise(r=>{setTimeout(()=>{const i=n.getCursor();const a=n.getLine(i.line);const s=h(a,i.ch);if(s){r({list:f(t(),s),from:e.Pos(i.line,s.argStart),to:e.Pos(i.line,s.argEnd)})}r(null)},100)})}}function p(e,t){const n=e.length;if(t.somethingSelected()){const r=t.getSelections();const i=r.map(t=>{if(t.length>=2*n&&t.startsWith(e)&&t.endsWith(e)){return t.substr(n,t.length-2*n)}return e+t+e});t.replaceSelections(i,"around")}else{const{line:r,ch:i}=t.getCursor();const a=t.getLine(r);const s=a.substr(0,i);const o=a.substr(i,n);if(s.endsWith(e)&&o===e){t.replaceRange("",{line:r,ch:i-n},{line:r,ch:i+n})}else{t.replaceRange(e+e,{line:r,ch:i});t.setCursor(r,i+n)}}}const v="variable-2";const g="meta";const b="variable";const w="status";function y(e,t,n=-1){e.state[e.state.length-1]=t;if(n>=0){e.indentation=n}}function O(e,t){e.state.push(t)}function j(e){e.state.pop()}function _(e){const t=e.match(/^\s+/);if(t&&typeof t[0]==="string"){return t[0].length}return 0}function x(e,t){const n=e.lookAhead(1);if(n!==undefined){return _(n)>t||n.trim().length===0}return false}function C(e,t){e.eatSpace();e.eatWhile(/[a-z]/);y(t,e.eol()?"normal":"argument");return"keyword"}function k(e,t,n){if(t.indentation<e.indentation()){e.skipToEnd();if(!x(e,t.indentation)){y(t,"normal")}return n}y(t,"normal");return null}function E(e,t,n=true){e.eatWhile(/[^"]/);e.next();if(n&&e.eol()){y(t,"normal")}return"string"}function S(e,t,n,r){if(e.match(r.character.repeat(2))){e.skipToEnd();if(x(e,n)){y(t,r.modeName,n)}return r.token}e.eatWhile(new RegExp(`[^\\${r.character}]`));if(e.eat(r.character)){return r.token}return null}function I(e,t){const n=e.next();const r=e.indentation();if(n==="%"&&e.match("%%")){e.skipToEnd();if(x(e,r)){y(t,"comment",r)}return"comment"}if(n==="$"){return S(e,t,r,{character:"$",modeName:"blockmath",token:v})}if(n==="`"){return S(e,t,r,{character:"`",modeName:"blockcode",token:w})}if(n==="#"&&r===0){if(e.peek()==="#"){e.skipToEnd();return"camp-step"}e.skipToEnd();return"camp-block"}if(n==="!"&&e.column()===0){e.eatWhile(/\s/);e.eatWhile(/[a-z0-9]/i);if(!e.eol()){y(t,"command")}return"keyword"}if(n==="?"&&e.column()===0){e.eatWhile(/[a-z ]/i);if(!e.eol()){y(t,"option")}return"keyword"}if(n==="|"&&e.column()===0&&e.eat(">")){return C(e,t)}if(n==="*"){if(!!e.eat("*")){if(!!e.match(/.*?\*\*/)){return"camp-bold"}return null}if(!!e.match(/.*?\*/)){return"camp-bold"}return null}if(n==="_"){if(!!e.eat("_")){if(!!e.match(/.*?__/)){return"camp-bold"}return null}if(!!e.match(/.*?_/)){return"camp-italic"}return null}if(n==="["){y(t,"annotation");O(t,"normal");return g}if(n==="]"){j(t);if(e.eol()){y(t,"normal")}return g}if(n===":"&&e.column()===0){return"keyword"}return null}function P(e,t){if(e.eat('"')){return E(e,t)}if(e.match("|>")){return C(e,t)}if(e.eat("[")){O(t,"normal");return g}if(e.eat("]")){j(t);return g}if(e.match(">>")){y(t,"normal");return g}if(e.match("vv")){e.skipToEnd();y(t,"normal");return g}if(e.match("->")){e.eat(">");y(t,"divert");return g}if(e.eol()){e.skipToEnd();y(t,"normal");return null}e.next();y(t,"normal");return null}function L(e,t){if(e.eat('"')){return E(e,t)}if(e.eat("[")){O(t,"normal");return g}if(e.eat("]")){j(t);return g}if(e.match("|>")){return C(e,t)}if(e.match(">>")){y(t,"normal");e.next();return g}if(e.match("vv")){y(t,"normal");e.skipToEnd();return g}if(e.eat("->")){e.eat(">");y(t,"divert");return g}if(e.eol()){y(t,"normal");return null}e.next();y(t,"normal");return null}function F(e,t){if(e.eat('"')){return E(e,t)}if(e.match("|>")){return C(e,t)}if(e.eat("[")){O(t,"normal");return g}if(e.eat("]")){j(t);return g}if(e.match(">>")){y(t,"normal");e.next();return g}if(e.match("vv")){y(t,"normal");e.skipToEnd();return g}e.next();y(t,"normal");return null}function $(e,t){return k(e,t,"comment")}function D(e,t){return k(e,t,v)}function T(e,t){return k(e,t,w)}function M(e,t){e.skipToEnd();y(t,"normal");return b}function U(e,t){if(e.eat("(")){return g}if(e.eat('"')){return E(e,t,false)}if(e.eat(")")){y(t,"normal");return g}e.next();return null}function A(){return{startState:()=>{return{state:["normal"],indentation:0}},token:(e,t)=>{e.eatSpace();const n=t.state[t.state.length-1]||"normal";switch(n){case"normal":return I(e,t);case"command":return P(e,t);case"option":return L(e,t);case"comment":return $(e,t);case"argument":return F(e,t);case"blockmath":return D(e,t);case"divert":return M(e,t);case"annotation":return U(e,t);case"blockcode":return T(e,t);default:Object(d["a"])(n)}},lineComment:"%%%"}}function W(e){e.defineMode("camperdown",A)}function z(e,t,n){const r=t.getLine(n);const i=r.search(/\S/);const a=t.getTokenTypeAt(e.Pos(n,i+1));if(i===-1||/\bcomment\b/.test(a)){return-1}return e.countColumn(r,null,t.getOption("tabSize"))}function N(e){const t=(t,n)=>{const r=z(e,t,n.line);if(r<0){return}let i=null;for(let a=n.line+1,s=t.lastLine();a<=s;a+=1){const n=z(e,t,a);if(n===-1){}else if(n>r){i=a}else{break}}if(i){return{from:e.Pos(n.line,t.getLine(n.line).length),to:e.Pos(i,t.getLine(i).length)}}return undefined};e.registerGlobalHelper("fold","indent",()=>true,t)}function R(e){const t=/^#[^#].*?$/;const n=/^##.*?$/;e.registerGlobalHelper("fold","camperdown",()=>true,(r,i)=>{const a=r.getLine(i.line);const s=t.test(a);const o=n.test(a);if(s||o){const a=r.lastLine();for(let s=i.line+1;s<=a;s+=1){const l=r.getLine(s);const c=s===a;if(t.test(l)||n.test(l)&&o||c){if(!c||r.getLine(s).trim()===""){do{s-=1}while(r.getLine(s).trim()==="")}return{from:e.Pos(i.line,r.getLine(i.line).length),to:e.Pos(s,r.getLine(s).length)}}}}return undefined})}function B(e){switch(e){case"block":return"cm-camp-line-block";case"step":return"cm-camp-line-step";default:Object(d["a"])(e)}}function V(e,t,n){e.addLineClass(t,"background",B(n))}function J(e,t,n){if(!n||n==="block"){e.removeLineClass(t,"background",B("block"))}if(!n||n==="step"){e.removeLineClass(t,"background",B("step"))}}function G(e){const t=B("block");const n=B("step");if(!e){return}let r=0;e.eachLine(({text:i})=>{var a;const s=((a=e.lineInfo(r))===null||a===void 0?void 0:a.bgClass)||"";const o=s===t;const l=s===n;if(i.startsWith("##")){if(o){J(e,r,"block")}if(!l){V(e,r,"step")}}else if(i.startsWith("#")){if(l){J(e,r,"step")}if(!o){V(e,r,"block")}}else if(o||l){J(e,r)}r+=1})}function K(e){return{line:e.line-1,ch:e.ch-1}}function q([e,t],[n,r]){if(n>=e&&r<=t){return true}if(e>=n&&t<=r){return true}if(n>=e&&n<=t){return true}if(r>=e&&r<=t){return true}return false}function H(e){return e?[e.from.line,e.to.line]:undefined}function Q(e,t,n){e.getAllMarks().forEach(e=>{var r;if((r=e.className)===null||r===void 0?void 0:r.includes(t)){if(n){const t=e.find();const r=[t.from.line,t.to.line];if(q(n,r)){e.clear()}}else{e.clear()}}})}function X(e,t){if(!e){return}const n="syntax-warning-highlight";Q(e,n);e.clearGutter(l["c"]);t.forEach(t=>{e.markText(Object.assign({},K(t.start)),Object.assign({},K(t.end)),{className:n,title:t.message});const r=document.createElement("span");r.classList.add("syntax-warning-gutter-mark");r.title=t.message;e.setGutterMarker(K(t.start).line,l["c"],r)})}function Y(e,t){if(!e){return}const n="cm-indent";const r=e.getOption("indentUnit")||4;const i=H(t);Q(e,n,i);let a=0;e.eachLine(t=>{const s=t.text.split("");let o=0;if(!i||q(i,[a,a])){while(s[o]&&s[o]===" "){o+=1;if(o%r===0){e.markText({ch:o-r,line:a},{ch:o,line:a},{className:n})}}}a+=1})}var Z=n(810);function ee(e,t){const n=t.length%e.options.indentUnit===0;const r=t.trim().length===0;return n&&r}let te=class e extends s["e"]{constructor(){super(...arguments);this.showCamperdownWarnings=true;this.showElmErrors=true}scrollInfo(){if(this.editor){return this.editor.getScrollInfo()}return null}refreshEditor(){if(this.isVisible&&this.editor){this.editor.refresh()}}valueChanged(){var e,t;if(this.editor){const n=((t=(e=this.editor)===null||e===void 0?void 0:e.right)===null||t===void 0?void 0:t.edit.getValue)?this.editor.right.edit.getValue():this.editor.getValue();if(this.value!==n){this.editor.setValue(this.value)}}}originalChanged(){if(this.editor&&this.editor.right){this.editor.rightOriginal().setValue(this.original)}}visibilityChanged(e,t){this.refreshEditor()}camperdownWarningsChanged(){this.updateCamperdownWarnings()}initEditor(){return Object(a["a"])(this,void 0,void 0,(function*(){const e=yield n.e(0).then(n.t.bind(null,121,7));yield Promise.all([Promise.all([n.e(0),n.e(59)]).then(n.t.bind(null,2568,7)),Promise.all([n.e(0),n.e(58)]).then(n.t.bind(null,2569,7)),n.e(49).then(n.t.bind(null,2570,7)),n.e(50).then(n.t.bind(null,2571,7)),Promise.all([n.e(0),n.e(52)]).then(n.t.bind(null,970,7)),Promise.all([n.e(0),n.e(57)]).then(n.t.bind(null,971,7)),Promise.all([n.e(0),n.e(40)]).then(n.t.bind(null,2572,7)),Promise.all([n.e(0),n.e(55)]).then(n.t.bind(null,1392,7)),Promise.all([n.e(0),n.e(56)]).then(n.t.bind(null,2573,7)),Promise.all([n.e(0),n.e(41)]).then(n.t.bind(null,2574,7)),Promise.all([n.e(0),n.e(42)]).then(n.t.bind(null,2575,7)),n.e(44).then(n.t.bind(null,2576,7)),n.e(48).then(n.t.bind(null,2577,7)),n.e(47).then(n.t.bind(null,2578,7)),Promise.all([n.e(0),n.e(53)]).then(n.t.bind(null,1393,7)),Promise.all([n.e(0),n.e(43)]).then(n.t.bind(null,2579,7)),n.e(45).then(n.t.bind(null,2580,7)),Promise.all([n.e(0),n.e(54)]).then(n.t.bind(null,2581,7)),n.e(46).then(n.t.bind(null,2582,7)),Promise.all([n.e(0),n.e(256)]).then(n.t.bind(null,2583,7)),n.e(245).then(n.t.bind(null,2584,7)),Promise.all([n.e(0),n.e(255)]).then(n.t.bind(null,2585,7)),Promise.all([n.e(0),n.e(257)]).then(n.t.bind(null,403,7)),Promise.all([n.e(0),n.e(254)]).then(n.t.bind(null,2586,7))]);N(e);const t=this.language==="camperdown";if(t){R(e);W(e.default)}const r=this.original!=null;let i={};if(t){i={"Cmd-B":e=>{p("**",e)},"Cmd-I":e=>{p("_",e)}};if(!Object(Z["h"])(navigator)){i=Object.assign(Object.assign({},i),{"Ctrl-B":e=>{p("**",e)},"Ctrl-I":e=>{p("_",e)}})}}const a={value:this.value,mode:this.language,lineNumbers:true,lineWrapping:true,scrollbarStyle:"simple",indentUnit:4,theme:"ttcn",readOnly:this.readOnly,foldGutter:true,inputStyle:"contenteditable",spellcheck:t,autoCloseBrackets:true,gutters:["CodeMirror-linenumbers","CodeMirror-foldgutter",l["c"]],extraKeys:Object.assign({Tab:e=>{if(e.somethingSelected()){e.indentSelection("add");return}e.execCommand("insertSoftTab")},"Shift-Tab":e=>{e.indentSelection("subtract")},Backspace:t=>{const{line:n,ch:r}=t.getCursor();const i=t.getSelection();const a=t.doc.getLine(n).substr(0,r);if(!i&&r>0&&ee(t,a)){const e=r-t.options.indentUnit;t.doc.replaceRange("",{line:n,ch:e},{line:n,ch:r})}else{return e.default.Pass}},Left:t=>{const{line:n,ch:r}=t.getCursor();const i=t.doc.getLine(n).substr(0,r);if(r>0&&ee(t,i)){t.setCursor({line:n,ch:r-t.options.indentUnit})}else{return e.default.Pass}},Right:t=>{const{line:n,ch:r}=t.getCursor();const i=t.doc.getLine(n);const a=i.substr(0,r);const s=i.substr(r,t.options.indentUnit);if(i.length>0&&ee(t,s)&&s.length>0&&s.trim().length===0){t.setCursor({line:n,ch:r+t.options.indentUnit})}else{return e.default.Pass}},"Alt-Up":e=>{Object(Z["f"])(e,-1)},"Alt-Down":e=>{Object(Z["f"])(e,1)},"Ctrl-/":e=>e.toggleComment({indent:true}),"Cmd-/":e=>e.toggleComment({indent:true})},i)};if(r){yield this.loadPatchIntoGlobalNamespace();const t=Object.assign(Object.assign({},a),{orig:this.original,showDifferences:true,panes:2,revertButtons:!this.readOnly});this.editor=e.MergeView(this.$refs.editor,t)}else{this.editor=e.default(this.$refs.editor,a)}if(r){this.editor.right.edit.doc.on("change",()=>{this.$emit("value-updated",this.editor.right.edit.getValue())})}else{this.editor.setOption("foldOptions",{widget:" [...]"});this.editor.doc.on("change",(e,n)=>{Object(c["d"])(()=>{const e=/\t/g;let r=this.editor.getValue();if(e.test(r)){const t=this.editor.getCursor();r=r.replace(e,"    ");this.editor.setValue(r);this.editor.setCursor(t)}else{this.$emit("value-updated",r)}if(t){G(this.editor)}Y(this.editor,n)})});this.editor.doc.on("cursorActivity",()=>{Object(c["d"])(()=>{this.$emit("cursor-updated",this.editor.getCursor())})});this.editor.on("viewportChange",this.triggerScrollChanged);this.editor.on("scroll",this.triggerScrollChanged)}if(t){if(!r){this.applyCamperdownOptions(e);this.updateCamperdownWarnings()}G(this.editor)}Y(this.editor)}))}updateCamperdownWarnings(){X(this.editor,this.camperdownWarnings)}triggerScrollChanged(){this.$emit("scroll-changed",this.scrollInfo())}applyCamperdownOptions(e){this.editor.setOption("hintOptions",{hint:m(e,()=>this.lessonAssets)});this.editor.on("keyup",(t,n)=>{const r=[13,37,38,39,40];const i=n.keyCode||n.which||0;if(!r.includes(i)){e.commands.autocomplete(this.editor,null,{completeSingle:false})}})}toggleCamperdownWarnings(){this.showCamperdownWarnings=!this.showCamperdownWarnings}toggleElmErrors(){this.showElmErrors=!this.showElmErrors}loadPatchIntoGlobalNamespace(){return Object(a["a"])(this,void 0,void 0,(function*(){const e=yield n.e(60).then(n.t.bind(null,2587,7));const{diff_match_patch:t,DIFF_INSERT:r,DIFF_DELETE:i,DIFF_EQUAL:a}=e.default;Object.assign(window,{diff_match_patch:t,DIFF_INSERT:r,DIFF_DELETE:i,DIFF_EQUAL:a})}))}mounted(){this.initEditor()}};Object(a["b"])([Object(s["c"])(String)],te.prototype,"value",void 0);Object(a["b"])([Object(s["c"])(String)],te.prototype,"language",void 0);Object(a["b"])([Object(s["c"])(Array)],te.prototype,"camperdownWarnings",void 0);Object(a["b"])([Object(s["c"])(Array)],te.prototype,"elmErrors",void 0);Object(a["b"])([Object(s["c"])(String)],te.prototype,"original",void 0);Object(a["b"])([Object(s["c"])({type:Boolean,default:false})],te.prototype,"readOnly",void 0);Object(a["b"])([Object(s["c"])({type:Boolean,default:true})],te.prototype,"showLangHeader",void 0);Object(a["b"])([Object(s["c"])({type:Boolean,default:false})],te.prototype,"withScroll",void 0);Object(a["b"])([Object(s["c"])({type:Boolean,default:false})],te.prototype,"isVisible",void 0);Object(a["b"])([Object(s["f"])("value")],te.prototype,"valueChanged",null);Object(a["b"])([Object(s["f"])("original")],te.prototype,"originalChanged",null);Object(a["b"])([Object(s["f"])("isVisible")],te.prototype,"visibilityChanged",null);Object(a["b"])([Object(s["f"])("camperdownWarnings")],te.prototype,"camperdownWarningsChanged",null);te=Object(a["b"])([Object(s["a"])({computed:Object.assign(Object.assign({},Object(o["mapGetters"])("lessonEditor",["lessonAssets"])),Object(o["mapGetters"])("globals",["featureSwitches"]))})],te);var ne=te;var re=ne;var ie=n(2234);var ae=n(10);var se=Object(ae["a"])(re,r,i,false,null,"00b49118",null);if(false){var oe}se.options.__file="frontend/views/lessons/editor/CodeEditor.vue";var le=t["a"]=se.exports},899:function(e,t,n){"use strict";var r=function(){var e=this;var t=e.$createElement;var n=e._self._c||t;return n("Modal",{staticClass:"figma-modal",on:{close:e.handleClose}},[n("header",[n("h2",[e._v("Import from Figma")]),e._v(" "),n("p",[e._v(e._s(e.text.subtitle))])]),e._v(" "),n("h3",[e._v("Figma link")]),e._v(" "),n("p",[e._v("The link must have "),n("code",[e._v("?node-id=...")]),e._v(" in the URL to work")]),e._v(" "),n("input",{attrs:{type:"text",placeholder:"https://www.figma.com/file/...?node-id=...",disabled:e.isLoading},on:{input:e.fetchFigmaAsset}}),e._v(" "),e.errorMessage||e.isLoading||e.isAssetLoaded?n("div",{staticClass:"preview-container"},[n("h3",[e._v("Preview")]),e._v(" "),e.errorMessage?n("p",{staticClass:"error",domProps:{innerHTML:e._s(e.errorMessage)}},[e._v("\n      "+e._s(e.errorMessage)+"\n    ")]):e.isLoading?n("LoadingAnimation",{staticClass:"loading-anim",attrs:{type:"spinner",color:"dark"}}):e.isAssetLoaded?n("img",{staticClass:"image-preview",attrs:{src:e.asset.url,width:e.asset.width}}):e._e()],1):e._e(),e._v(" "),n("div",{staticClass:"form-footer"},[n("button",{staticClass:"btn btn-accent",attrs:{disabled:!e.isAssetLoaded},on:{click:e.handleCreateAsset}},[e._v("\n      "+e._s(e.text.button)+"\n    ")])])])};var i=[];r._withStripped=true;var a=n(1);var s=n(5);var o=n(261);var l=n(23);var c=n(6);var d=n(778);var u=n(260);var h=n(15);let f=class e extends s["e"]{constructor(){super(...arguments);this.isLoading=false;this.errorMessage=null;this.asset=null}get text(){switch(this.useCase){case"create-asset":return{subtitle:"Create a new asset from a Figma link",button:"Create asset"};case"add-image":return{subtitle:"Import an image from a Figma link",button:"Import image"};case"replace-asset":return{subtitle:"Update this asset by importing a new one",button:"Update asset"};default:Object(o["a"])(this.useCase)}}get isAssetLoaded(){return this.asset!==null}handleClose(){this.$emit("close")}handleRequestError(e){var t,n;const r=(n=(t=e.response)===null||t===void 0?void 0:t.status,n!==null&&n!==void 0?n:"unknown");this.errorMessage=`Request error (${r})`;this.isLoading=false}startFigmaImport(e){var t;return Object(a["a"])(this,void 0,void 0,(function*(){let n;try{n=yield Object(c["c"])(Object(h["b"])({name:"figma_import_start"}).href,Object(l["c"])({figma_url:e}))}catch(e){this.handleRequestError(e);return null}return((t=n.results)===null||t===void 0?void 0:t.figma_import_results)||null}))}checkFigmaImport(e){var t;return Object(a["a"])(this,void 0,void 0,(function*(){let n;try{n=yield Object(c["c"])(Object(h["b"])({name:"figma_import_status"}).href,Object(l["c"])({figma_import_id:e}))}catch(e){this.handleRequestError(e);return null}return((t=n.results)===null||t===void 0?void 0:t.figma_import_results)||null}))}figmaImportStatusPoll(e){return new Promise(t=>{const n=()=>Object(a["a"])(this,void 0,void 0,(function*(){setTimeout(()=>Object(a["a"])(this,void 0,void 0,(function*(){var r;try{const i=yield this.checkFigmaImport(e);if((r=i)===null||r===void 0?void 0:r.processing){n()}else{t(i)}}catch(e){this.handleRequestError(e);t(null)}})),1e3)}));n()})}fetchFigmaAsset(e){var t;return Object(a["a"])(this,void 0,void 0,(function*(){const n=e.target.value;this.errorMessage=null;this.asset=null;if(!n){return}this.isLoading=true;const r=yield this.startFigmaImport(n);if(!r||!r.success){this.errorMessage=((t=r)===null||t===void 0?void 0:t.error)||"Unexpected error starting import";this.isLoading=false;return}if(!r.import_id){throw new Error("Figma import initial request returned success but didn't have an import_id.")}else{const e=yield this.figmaImportStatusPoll(r.import_id);if(e===null){this.errorMessage="Unexpected error while checking import status"}else if(e.error){this.errorMessage=e.error}else{this.asset={slug:e.image_slug||"",url:e.image_url||"",width:e.image_width||300,height:e.image_height||300}}}this.isLoading=false}))}handleCreateAsset(){this.$emit("asset-added",this.asset);this.asset=null;this.handleClose()}};Object(a["b"])([Object(s["c"])(String)],f.prototype,"useCase",void 0);f=Object(a["b"])([Object(s["a"])({components:{Modal:d["a"],LoadingAnimation:u["a"]}})],f);var m=f;var p=m;var v=n(2236);var g=n(10);var b=Object(g["a"])(p,r,i,false,null,"5afe4ba4",null);if(false){var w}b.options.__file="frontend/views/lessons/editor/FigmaImportModal.vue";var y=t["a"]=b.exports}}]);
//# sourceMappingURL=AuthorsDiagrammarExamples-LessonEditor.2c8e42caae1abb1e46b0.js.map