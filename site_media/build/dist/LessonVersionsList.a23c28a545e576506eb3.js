(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([[102],{1107:function(e,n,t){"use strict";var a=t(872);var r=t.n(a);var s=r.a},1108:function(e,n,t){n=e.exports=t(27)(false);n.push([e.i,"",""])},1109:function(e,n,t){var a=t(2224);if(typeof a==="string")a=[[e.i,a,""]];if(a.locals)e.exports=a.locals;var r=t(28).default;var s=r("6df7fbaf",a,false,{});if(false){}},1297:function(e,n,t){"use strict";var a=function(){var e=this;var n=e.$createElement;var t=e._self._c||n;return t("router-link",{staticClass:"btn nav-btn",attrs:{to:{name:"authors_dashboard"},title:"Authoring home"}},[t("span",{staticClass:"b-sprite-quiz-v3-home"})])};var r=[];a._withStripped=true;var s=t(1);var i=t(5);let o=class e extends i["e"]{};o=Object(s["b"])([i["a"]],o);var c=o;var d=c;var l=t(1107);var f=t(10);var b=Object(f["a"])(d,a,r,false,null,"c9ca534c",null);if(false){var u}b.options.__file="frontend/views/lessons/editor/AuthoringHomeButton.vue";var v=n["a"]=b.exports},2223:function(e,n,t){"use strict";var a=t(1109);var r=t.n(a);var s=r.a},2224:function(e,n,t){n=e.exports=t(27)(false);n.push([e.i,'@use "sass:map";\n.no-scroll[data-v-32eecd0f] {\n  position: relative;\n  z-index: 100;\n  overflow: hidden;\n}\nmain[data-v-32eecd0f] {\n  display: flex;\n  flex-direction: column;\n  position: absolute;\n  top: 0;\n  left: 0;\n  width: 100vw;\n  height: 100vh;\n  overflow: hidden;\n  background: #FFFFFF;\n}\nmain header.header[data-v-32eecd0f] {\n    display: flex;\n    flex-direction: column;\n}\nmain header.header .nav-bar[data-v-32eecd0f] {\n      display: flex;\n      align-items: center;\n      padding: 16px;\n}\nmain header.header .nav-bar[data-v-32eecd0f]  .nav-btn {\n        display: flex;\n        align-items: center;\n        padding: 4px 8px;\n}\nmain header.header .nav-bar[data-v-32eecd0f]  .nav-btn + .nav-btn {\n          margin-left: 8px;\n}\nmain header.header .nav-bar .title-block[data-v-32eecd0f] {\n        flex: 1;\n        padding: 0 16px;\n}\nmain header.header .nav-bar .title-block h2[data-v-32eecd0f] {\n          margin: 0;\n}\nmain .tabs[data-v-32eecd0f] {\n    flex: none;\n    display: flex;\n    justify-content: flex-start;\n    border: 1px solid #ccc;\n    border-width: 1px 0;\n    background: #f3f3f3;\n}\nmain .tabs button[data-v-32eecd0f] {\n      display: flex;\n      justify-content: center;\n      align-items: center;\n      height: 30px;\n      padding: 0 16px;\n      margin: 0;\n      border: 0;\n      font-size: 15px;\n      background: transparent;\n      color: #000000;\n}\nmain .tabs button.active[data-v-32eecd0f] {\n        font-weight: bold;\n        background: rgba(0, 0, 0, 0.1);\n}\nmain .tabs button.active[data-v-32eecd0f]:hover {\n          background: rgba(0, 0, 0, 0.1);\n}\nmain .tabs button[data-v-32eecd0f]:hover {\n        background: rgba(0, 0, 0, 0.05);\n}\n.page-body[data-v-32eecd0f] {\n  padding: 24px 24px;\n  overflow-y: auto;\n}\n.version-cards[data-v-32eecd0f] {\n  display: grid;\n  grid-template-columns: repeat(auto-fill, 300px);\n  gap: 24px;\n  margin: 0;\n  list-style: none;\n}\n.card[data-v-32eecd0f] {\n  position: relative;\n  border: 1px solid #EEA71F;\n  border-radius: 7px;\n  transition: box-shadow 100ms;\n  overflow: hidden;\n}\n.card[data-v-32eecd0f]:hover {\n    box-shadow: 3px 5px 10px #C4C4C4;\n}\n.card.draft[data-v-32eecd0f] {\n    border-color: #EEA71F;\n}\n.card.draft header[data-v-32eecd0f] {\n      background: #EEA71F;\n}\n.card.published[data-v-32eecd0f] {\n    border-color: #179E7E;\n}\n.card.published header[data-v-32eecd0f] {\n      background: #179E7E;\n}\n.card.experimental[data-v-32eecd0f] {\n    border-color: #48d1cc;\n}\n.card.experimental header[data-v-32eecd0f] {\n      background: #48d1cc;\n}\n.card.retired[data-v-32eecd0f] {\n    border-color: #a4aab0;\n}\n.card.retired header[data-v-32eecd0f] {\n      background: #a4aab0;\n}\n.card.legacy[data-v-32eecd0f] {\n    border-color: #575d64;\n}\n.card.legacy header[data-v-32eecd0f] {\n      background: #575d64;\n}\n.card header[data-v-32eecd0f] {\n    display: flex;\n    flex-direction: row;\n    align-items: center;\n    justify-content: space-between;\n    padding: 0 8px;\n    background: #EEA71F;\n}\n.card header *[data-v-32eecd0f] {\n      color: #FFFFFF;\n}\n.card header h3[data-v-32eecd0f] {\n      margin: 0;\n}\n.version-link[data-v-32eecd0f] {\n  display: flex;\n  flex-direction: column;\n  height: 100%;\n}\n.preview-link[data-v-32eecd0f] {\n  position: absolute;\n  top: 4px;\n  right: 8px;\n  border: 1px solid #FFFFFF;\n  border-radius: 4px;\n  line-height: 1.2;\n  padding: 0 4px;\n  color: #FFFFFF;\n  transition: color 100ms linear, background-color 100ms linear;\n}\n.preview-link[data-v-32eecd0f]:hover {\n    color: #1F1F1F;\n    background: #FFFFFF;\n}\n.card-body[data-v-32eecd0f] {\n  flex: 1;\n  padding: 16px 24px;\n}\n.card-body p[data-v-32eecd0f] {\n    color: #899098;\n    margin: 0 0 4px 0;\n    line-height: 1.4em;\n}\n.card-body p[data-v-32eecd0f]:last-child {\n      margin: 0;\n}\n.card-body p.state[data-v-32eecd0f] {\n      font-weight: bold;\n      text-transform: capitalize;\n}\n.empty[data-v-32eecd0f] {\n  width: 100%;\n  display: flex;\n  justify-content: center;\n  align-items: center;\n  height: 200px;\n  color: rgba(0, 0, 0, 0.5);\n}\n[data-v-32eecd0f] .btn {\n  height: 38px;\n  border-radius: 6px;\n  font-size: 18px;\n}\n[data-v-32eecd0f] .btn:not(.btn-accent) {\n    border-color: #c4c4c4;\n    color: #000000;\n    background: #FFFFFF;\n}\n[data-v-32eecd0f] .btn:not(.btn-accent):hover {\n      border-color: #000000;\n      color: #000000;\n}\n[data-v-32eecd0f] .btn:not(.btn-accent):disabled:hover {\n      border-color: #c4c4c4;\n}\n[data-v-32eecd0f] .btn.btn-accent {\n    border: 0;\n    background: #000000;\n    color: #FFFFFF;\n}\n[data-v-32eecd0f] .btn.btn-outline {\n    background: transparent;\n    border-color: #000000;\n}\n.staff-member[data-v-32eecd0f] {\n  font-size: 14px;\n  color: rgba(0, 0, 0, 0.5);\n}\n.staff-member p[data-v-32eecd0f] {\n    margin: 0;\n}\n.staff-member .btn-link[data-v-32eecd0f] {\n    margin-left: 8px;\n    color: rgba(0, 0, 0, 0.5);\n    text-decoration: underline;\n}\n.staff-member .btn-link[data-v-32eecd0f]:hover {\n      color: rgba(0, 0, 0, 0.8);\n      text-decoration: none;\n}\n.staff-member-form[data-v-32eecd0f] {\n  font-size: 14px;\n}\n.staff-member-form select[data-v-32eecd0f] {\n    height: 32px;\n    margin: 0;\n    border-radius: 6px;\n}\n.staff-member-form .btn[data-v-32eecd0f] {\n    height: 32px;\n    margin: -1px 0 0 8px;\n    font-size: inherit;\n}\n.staff-member-form .btn-link[data-v-32eecd0f] {\n    margin-left: 8px;\n    color: rgba(0, 0, 0, 0.5);\n    text-decoration: underline;\n}\n.staff-member-form .btn-link[data-v-32eecd0f]:hover {\n      color: rgba(0, 0, 0, 0.8);\n      text-decoration: none;\n}\n.staff-member-form .error[data-v-32eecd0f] {\n    margin: 0;\n    color: tomato;\n}\n',""])},261:function(e,n,t){"use strict";t.d(n,"a",(function(){return a}));function a(e){throw new Error("Unreachable case")}},2614:function(e,n,t){"use strict";t.r(n);var a=function(){var e=this;var n=e.$createElement;var t=e._self._c||n;return t("main",[t("header",{staticClass:"header"},[t("div",{staticClass:"nav-bar"},[t("router-link",{staticClass:"nav-btn btn",attrs:{to:e.backButtonInfo.url,title:e.backButtonInfo.title}},[e._v("\n        ‚Üê\n      ")]),e._v(" "),!e.isSandboxLesson?t("AuthoringHomeButton"):e._e(),e._v(" "),t("div",{staticClass:"title-block"},[t("h2",[e._v(e._s(e.mainLessonVersion.lesson_title))]),e._v(" "),e.showStaffMemberResponsibleForm?t("form",{staticClass:"staff-member-form",on:{submit:function(n){n.preventDefault();return e.handleSubmitStaffMemberResponsibleForm(n)}}},[t("select",{directives:[{name:"model",rawName:"v-model",value:e.staffMemberResponsibleUserIdChoice,expression:"staffMemberResponsibleUserIdChoice"}],on:{change:function(n){var t=Array.prototype.filter.call(n.target.options,(function(e){return e.selected})).map((function(e){var n="_value"in e?e._value:e.value;return n}));e.staffMemberResponsibleUserIdChoice=n.target.multiple?t:t[0]}}},[t("option",{attrs:{value:"null"}},[e._v("\n              Use default for this chapter\n            ")]),e._v(" "),e._l(e.staffMetaData,(function(n){return t("option",{key:n.staff_user_id,domProps:{value:n.staff_user_id}},[e._v("\n              "+e._s(n.staff_user_full_name)+"\n            ")])}))],2),e._v(" "),t("button",{staticClass:"btn",attrs:{disabled:e.isSavingStaffMemberResponsible}},[e._v("\n            Save\n          ")]),e._v(" "),t("button",{staticClass:"btn-link",attrs:{disabled:e.isSavingStaffMemberResponsible},on:{click:function(n){n.stopPropagation();e.showStaffMemberResponsibleForm=false}}},[e._v("\n            Cancel\n          ")]),e._v(" "),e.staffMemberResponsibleError?t("p",{staticClass:"error"},[e._v("\n            "+e._s(e.staffMemberResponsibleError)+"\n          ")]):e._e()]):t("div",{staticClass:"staff-member"},[t("p",{attrs:{title:e.staffMemberResponsible.reason}},[t("b",[e._v("Responsible staff member:")]),e._v("\n            "+e._s(e.staffMemberResponsibleText)+"\n            "),t("button",{staticClass:"btn-link",on:{click:function(n){e.showStaffMemberResponsibleForm=true}}},[e._v("Change this")])])])])],1),e._v(" "),t("div",{staticClass:"tabs"},[t("button",{class:{active:e.activeTab==="active"},on:{click:function(n){e.activeTab="active"}}},[e._v("Active versions")]),e._v(" "),t("button",{class:{active:e.activeTab==="legacy"},on:{click:function(n){e.activeTab="legacy"}}},[e._v("Legacy and retired versions")])])]),e._v(" "),t("div",{staticClass:"page-body"},[e.dynamicLessonVersions.length?t("ul",{staticClass:"version-cards"},e._l(e.dynamicLessonVersions,(function(n){var a;return t("li",{key:n.version_id,staticClass:"card",class:(a={},a[n.version_state.toLowerCase()]=true,a)},[t("router-link",{staticClass:"preview-link",attrs:{to:n.lesson_url}},[e._v("Preview")]),e._v(" "),t("router-link",{staticClass:"version-link",attrs:{to:n.edit_url}},[t("header",[t("h3",[e._v(e._s(n.version_name))])]),e._v(" "),t("div",{staticClass:"card-body"},[t("p",[e._v(e._s(n.created_by_name))]),e._v(" "),t("p",[e._v(e._s(n.internal_change_reason))]),e._v(" "),t("p",[e._v(e._s(e.formatTs(n.last_modified_ts)))]),e._v(" "),t("p",{staticClass:"state"},[e._v(e._s(n.version_state.toLowerCase()))])])])],1)})),0):t("div",{staticClass:"empty"},[t("p",[e._v("There are no "+e._s(e.activeTab)+" versions to display.")])])])])};var r=[];a._withStripped=true;var s=t(1);var i=t(5);var o=t(9);var c=t(895);var d=t(261);var l=t(810);var f=t(1297);let b=class e extends i["e"]{constructor(){super(...arguments);this.activeTab="active";this.showStaffMemberResponsibleForm=false;this.staffMemberResponsibleUserIdChoice="null";this.isSavingStaffMemberResponsible=false;this.staffMemberResponsibleError=null}get isSandboxLesson(){return["sandbox","none"].includes(this.$route.params.courseSlug)&&this.user.is_external_lesson_author}get backButtonInfo(){if(this.isSandboxLesson){return{title:"Authoring home",url:this.$router.resolve({name:"authors_dashboard"}).href}}return{title:"Back to course page",url:this.$router.resolve({name:"explorations_chapter",params:Object(l["e"])(this.$route)}).href}}get dynamicLessonVersions(){switch(this.activeTab){case"active":return this.activeLessonVersions;case"legacy":return this.legacyLessonVersions}}isLegacyOrRetired(e){return e.version_state==="LEGACY"||e.version_state==="RETIRED"}get activeLessonVersions(){return this.lessonVersions.filter(e=>!this.isLegacyOrRetired(e))}get legacyLessonVersions(){return this.lessonVersions.filter(this.isLegacyOrRetired)}get mainLessonVersion(){const e=this.lessonVersions.filter(e=>e.version_state==="PUBLISHED");if(e.length){return e[0]}if(this.activeLessonVersions.length){return this.activeLessonVersions[0]}return this.lessonVersions[0]}get staffMemberResponsibleText(){const e=this.staffMemberResponsible.user_full_name||"";switch(this.staffMemberResponsible.object_type){case"lesson":return e;case"chapter":return`${e} (default from chapter)`;case"course":return`${e} (default from course)`;case"unknown":return"Not set, and no available fallback from chapter or course";default:Object(d["a"])(this.staffMemberResponsible.object_type)}}get timeFormat(){return Object.assign(Object.assign({},c["DateTime"].DATETIME_MED),{timeZoneName:"short"})}formatTs(e){return c["DateTime"].fromISO(e).toLocaleString(this.timeFormat)}handleSubmitStaffMemberResponsibleForm(){return Object(s["a"])(this,void 0,void 0,(function*(){this.isSavingStaffMemberResponsible=true;const e={params:Object(l["e"])(this.$route),data:{staff_user_id:this.staffMemberResponsibleUserIdChoice==="null"?undefined:this.staffMemberResponsibleUserIdChoice}};const n=yield this.$store.dispatch("lessonVersions/updateStaffMemberResponsible",e);this.isSavingStaffMemberResponsible=false;if(n.success){this.showStaffMemberResponsibleForm=false;this.staffMemberResponsibleError=null}else{this.staffMemberResponsibleError="There was an error while trying to update the responsible staff member"}}))}mounted(){if(this.staffMemberResponsible.user_id&&this.staffMemberResponsible.object_type==="lesson"){this.staffMemberResponsibleUserIdChoice=this.staffMemberResponsible.user_id}}};b=Object(s["b"])([Object(i["a"])({components:{AuthoringHomeButton:f["a"]},computed:Object.assign(Object.assign(Object.assign(Object.assign({},Object(o["mapState"])("lessonVersions",["lessonVersions"])),Object(o["mapState"])("staffMemberResponsible",["staffMemberResponsible"])),Object(o["mapState"])("staffMetaData",["staffMetaData"])),Object(o["mapState"])("globals",["user"])),metaInfo:{title:"Versions"}})],b);var u=b;var v=u;var p=t(2223);var m=t(10);var h=Object(m["a"])(v,a,r,false,null,"32eecd0f",null);if(false){var g}h.options.__file="frontend/views/lessons/editor/LessonVersionsList.vue";var _=n["default"]=h.exports},810:function(e,n,t){"use strict";t.d(n,"e",(function(){return r}));t.d(n,"c",(function(){return s}));t.d(n,"a",(function(){return i}));t.d(n,"b",(function(){return o}));t.d(n,"d",(function(){return c}));t.d(n,"g",(function(){return l}));t.d(n,"f",(function(){return f}));t.d(n,"h",(function(){return b}));var a=t(178);function r(e){return{courseSlug:e.params.courseSlug,chapterSlug:e.params.chapterSlug,lessonSlug:e.params.lessonSlug}}function s(e){switch(e.type){case"compile-errors":return e.errors.map(e=>e.problems.map(e=>e.message.map(e=>{if(typeof e==="string"){return e}if("string"in e){return e.string}return`${e}`}).join("")).join("")).flat().join("\n------------------------\n").replace(/\n\n/g,"\n");case"error":return e.message.join("\n------------------------\n");default:return`${e}`}}function i(e){return e.map(e=>{if(typeof e!=="string"){return e.string}return e}).join("")}function o(e){return{row:e.region.start.line,column:e.region.start.column,type:"error",text:i(e.message)}}function c(e){const n={view:a["b"]};const[t,r,s]=e.hash.split("/");if(r){switch(r){case"camperdown":case"assets":case"settings":case"customElm":case"compiledElmMain":return{view:r,subview:s&&s.trim().length?s:undefined};default:return n}}return n}function d({view:e,subview:n}){if(e==="camperdown"){return undefined}return n?`#/${e}/${n}/`:`#/${e}/`}function l(e,n,t,a=false){const{view:r,subview:s}=c(n);if(r!==t.view||s!==t.subview){const r=Object.assign(Object.assign({},n),{hash:d(t)});if(a){e.replace(r)}else{e.push(r)}}}function f(e,n){const{line:t,ch:a}=e.getCursor();if(t>0&&n<0||t<e.lastLine()&&n>0){const r=`${e.doc.getLine(t)}\n`;e.replaceRange("",{line:t,ch:0},{line:t+1,ch:0});e.replaceRange(r,{line:t+n,ch:0});e.setCursor({ch:a,line:t+n})}}function b(e){return/Apple Computer/.test(e.vendor)||/Mac/.test(e.platform)}},872:function(e,n,t){var a=t(1108);if(typeof a==="string")a=[[e.i,a,""]];if(a.locals)e.exports=a.locals;var r=t(28).default;var s=r("0146e0f4",a,false,{});if(false){}}}]);
//# sourceMappingURL=LessonVersionsList.a23c28a545e576506eb3.js.map